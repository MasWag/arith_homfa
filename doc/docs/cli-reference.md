# 7. Command-Line Reference

## 7.1 Global CLI layout

`ahomfa_util [--verbose|--quiet] <subcommand> [options]`

Key subcommands:

| Subcommand family | Description |
| --- | --- |
| `ckks …` | Microsoft SEAL (CKKS) keygen and encryption helpers. Require `-c/--config` pointing to a JSON config. |
| `tfhe …` | TFHEpp helpers for TLWE/TRGSW material. Some commands also need the CKKS config and SEAL secret key. |
| `ltl2spec` / `spec2spec` | Translate or post-process DFA specifications. |

Use `-v/--verbose` or `-q/--quiet` for log level, and append `-h` to any subcommand for the autogenerated help text (`doc/ahomfa_util.md` mirrors the same information).

## 7.2 CKKS subcommands

All CKKS commands require `-c CONFIG.json` (see `examples/blood_glucose/config.json` for the schema) and accept `-o OUTPUT` to redirect binary output; otherwise they write to stdout. Inputs default to stdin unless `-i FILE` is supplied.

| Command | Purpose | Required options |
| --- | --- | --- |
| `ckks genkey` | Generate a CKKS secret key. | `-c CONFIG` |
| `ckks genpkey` | Emit a public key derived from an existing secret. | `-c CONFIG`, `-K CKKS_SECRET` |
| `ckks genrelinkey` | Emit a relinearization key. | `-c CONFIG`, `-K CKKS_SECRET` |
| `ckks enc` | Encrypt plaintext samples. | `-c CONFIG`, one of `-K CKKS_SECRET` or `-k CKKS_PUBLIC`; optional `-i PLAINTEXT`, `-o CIPHERTEXT` |
| `ckks dec` | Decrypt CKKS ciphertexts. | `-c CONFIG`, `-K CKKS_SECRET`; optional `-i CIPHERTEXT`, `-o PLAINTEXT` |

The encoder expects whitespace-separated real numbers; encryption writes a length-prefixed binary stream understood by the monitors. Decryption emits decoded doubles, one per line.

## 7.3 TFHE subcommands

| Command | Purpose | Required options |
| --- | --- | --- |
| `tfhe genkey` | Generate a TFHE secret key. | `-o TFHE_SECRET` (stdout if omitted) |
| `tfhe genbkey` | Produce a bootstrapping key (large, multi‑GB). | `-K TFHE_SECRET`, `-c CONFIG`, `-S CKKS_SECRET`, `-o TFHE_BKEY` |
| `tfhe enc` | Encrypt boolean traces into TLWE ciphertexts. | `-K TFHE_SECRET`; optional `-i PLAINTEXT`, `-o TLWE_STREAM` |
| `tfhe dec` | Decrypt TLWE ciphertexts. | `-K TFHE_SECRET`; optional `-i TLWE_STREAM`, `-o PLAINTEXT`, `--vertical` to interpret messages in the {−¼,+¼} domain when applicable |

`tfhe genbkey` internally loads the CKKS secret via `-S` and the CKKS config via `-c` so it can run the CKKS→TFHE conversion; expect it to run for minutes to hours depending on hardware. Encryption/decryption defaults follow the same stdin/stdout convention as the CKKS tools.

## 7.4 Specification tooling

| Command | Purpose | Required options |
| --- | --- | --- |
| `ltl2spec` | Convert a Spot-compatible LTL/STL formula into an ArithHomFA DFA. | `-e FORMULA`, `-n NUM_VARS`, `-o SPEC` |
| | | Optional: `--make-all-live-states-final` keeps every strongly connected live state accepting (useful for reversed monitors). |
| `spec2spec` | Transform an existing DFA. | `-i SPEC`, `-o SPEC` plus one or more of `--reverse`, `--negate`, `--minimize` |

The reference Bats test in `bats/ltl2spec.bats` rebuilds `ahomfa_util`, runs `ltl2spec`, and diffs the emitted DFA against the curated blood-glucose specs; use it as a regression suite when changing CLI behavior or following the documentation examples.

## 7.5 I/O defaults and environment knobs

- Any command that accepts `-i/--input` or `-o/--output` falls back to stdin/stdout when the flag is omitted, allowing easy composition with pipes.
- Keys and ciphertexts are emitted as portable-binary archives or TLWE/CKKS blobs; treat them as opaque files.
- `SPDLOG_LEVEL` tunes logging for CLI utilities and monitors (`debug`, `info`, `warn`, …).
- `SEAL_THROW_ON_TRANSPARENT=1` is useful during predicate development to catch transparent ciphertexts early.
- OpenMP variables (`OMP_NUM_THREADS`, `OMP_DISPLAY_ENV`) can be used to bound parallelism during heavy encrypted runs.
